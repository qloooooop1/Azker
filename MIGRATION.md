# ุฏููู ุงูุชุฑุญูู - Migration Guide

## ุงูุชุฑุญูู ูู ุงูุชุฎุฒูู ุงููุคูุช ุฅูู ุงูุชุฎุฒูู ุงูุฏุงุฆู
## Migration from Temporary to Persistent Storage

---

### ูุธุฑุฉ ุนุงูุฉ | Overview

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงูุชุฑุญูู ูู ุงููุธุงู ุงููุฏูู (ุญูุซ ูุงูุช ุงูุจูุงูุงุช ุชูููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู) ุฅูู ุงููุธุงู ุงูุฌุฏูุฏ ูุน ุงูุชุฎุฒูู ุงูุฏุงุฆู.

This guide explains how to migrate from the old system (where data was lost on restart) to the new system with persistent storage.

---

### ูุง ุงูุฐู ุชุบูุฑุ | What Changed?

#### ุงููุฏูู | Old System
```
/app/
โโโ adkar.db          # ููููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุงููุดุฑ
โโโ uploads/          # ููููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุงููุดุฑ
```

#### ุงูุฌุฏูุฏ | New System
```
/data/                # ูุฑุต ุฏุงุฆู - ูุง ููููุฏ ุฃุจุฏุงู
โโโ adkar.db          # ูุญููุธ ุฏุงุฆูุงู
โโโ uploads/          # ูุญููุธ ุฏุงุฆูุงู
    โโโ audio/
    โโโ images/
    โโโ pdfs/
    โโโ temp/
```

---

### ุฎุทูุงุช ุงูุชุฑุญูู ุนูู Render | Migration Steps on Render

#### 1. ุงูุชุญูู ูู ุงููุฑุต ุงูุฏุงุฆู | Verify Persistent Disk

ุชุฃูุฏ ูู ุฃู ููู `render.yaml` ูุญุชูู ุนูู:

```yaml
disk:
  name: adkar-data
  mountPath: /data
  sizeGB: 1
```

ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุฃุถูู ูุฃุนุฏ ุงููุดุฑ.

#### 2. ุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ | Set Environment Variable

ูู ููุญุฉ ุชุญูู Render:
1. ุงุฐูุจ ุฅูู ุฅุนุฏุงุฏุงุช ุงูุฎุฏูุฉ (Service Settings)
2. ุชุญุช Environmentุ ุชุฃูุฏ ูู:
   ```
   NODE_ENV=production
   ```

#### 3. ุฅุนุงุฏุฉ ุงููุดุฑ | Redeploy

ุจุนุฏ ุฏูุฌ ูุฐู ุงูุชุบููุฑุงุช:
1. ูู ุจุฅุนุงุฏุฉ ูุดุฑ ุงูุฎุฏูุฉ (Redeploy)
2. ุณูุชู ุฅูุดุงุก `/data` ุชููุงุฆูุงู
3. ุณุชุจุฏุฃ ุงูุจูุงูุงุช ุจุงูุญูุธ ูู ุงูููุงู ุงูุตุญูุญ

#### 4. ุงูุชุญูู ูู ุงููุฌุงุญ | Verify Success

ุชุญูู ูู ุงูุณุฌูุงุช (Logs) ูุงุจุญุซ ุนู:
```
โ ุชู ุฅูุดุงุก ูุฌูุฏ ุงูุจูุงูุงุช: /data
๐ ูุณุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช: /data/adkar.db
โ ุชู ุฅูุดุงุก ูุฌูุฏ ุงููููุงุช: /data/uploads
```

---

### ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ | Restore Old Data

ุฅุฐุง ูุงู ูุฏูู ุจูุงูุงุช ูู ูุจู ุงูุชุฑุญูู ูุชุฑูุฏ ุงูุงุญุชูุงุธ ุจูุง:

#### ุงูุทุฑููุฉ 1: ูู ุฎูุงู Shell ูู Render

1. ุงูุชุญ Shell ูู Render Dashboard
2. ููุฐ ุงูุฃูุงูุฑ:
```bash
# ุฅุฐุง ูุงู ูุฏูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ
cp /app/backup-old.db /data/adkar.db

# ุฃู ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูู ุงูููุงู ุงููุฏูู
cp /app/adkar.db /data/adkar.db 2>/dev/null || echo "No old db found"

# ูุณุฎ ุงููููุงุช
cp -r /app/uploads/* /data/uploads/ 2>/dev/null || echo "No old uploads"
```

#### ุงูุทุฑููุฉ 2: ูู ุฎูุงู ููุญุฉ ุงูุชุญูู

1. ุงูุชุญ ููุญุฉ ุชุญูู ุงูุจูุช
2. ุฃุถู ุงูุฃุฐูุงุฑ ูู ุฌุฏูุฏ
3. ุณุชูุญูุธ ุชููุงุฆูุงู ูู `/data`

---

### ูุตุงุฆุญ ูููุฉ | Important Tips

#### โ ุงูุนู | DO

- ุงุณุชุฎุฏู ููุญุฉ ุงูุชุญูู ูุฅุถุงูุฉ ุงูุฃุฐูุงุฑ
- ุฑุงูุจ ุณุฌูุงุช ุงูุชุทุจูู ููุชุฃูุฏ ูู ุงููุณุงุฑ ุงูุตุญูุญ
- ูู ุจุนูู ูุณุฎ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ

#### โ ูุง ุชูุนู | DON'T

- ูุง ุชุญุฐู ูุฌูุฏ `/data` ูุฏููุงู
- ูุง ุชุบูุฑ ุญุฌู ุงููุฑุต ุฅูู 0 GB
- ูุง ุชุญูุธ ุจูุงูุงุช ุญุณุงุณุฉ ูู version control

---

### ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ | FAQ

#### ุณ: ูู ุณุฃููุฏ ุงูุจูุงูุงุช ุงููุฏููุฉุ
ุฌ: ุงูุจูุงูุงุช ุงููุฏููุฉ ุงูุชู ูุงูุช ูู `/app` ุณุชูููุฏ ุนูุฏ ุฃูู ุฅุนุงุฏุฉ ูุดุฑ ุจุนุฏ ุงูุชุฑุญูู. ููู ุจุนุฏ ุฐููุ ุฌููุน ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุณุชูุญูุธ.

**Q: Will I lose old data?**
**A:** Old data in `/app` will be lost on first redeploy after migration. But after that, all new data will be saved.

#### ุณ: ููู ุฃุชุญูู ูู ุญุฌู ุงูุจูุงูุงุชุ
ุฌ: ูู Shell:
```bash
du -sh /data
```

**Q: How do I check data size?**
**A:** In Shell:
```bash
du -sh /data
```

#### ุณ: ูุงุฐุง ูู ุงูุชูุฃ ุงููุฑุตุ
ุฌ: ููููู ุฒูุงุฏุฉ ุญุฌู ุงููุฑุต ูู ุฅุนุฏุงุฏุงุช Renderุ ุฃู ุญุฐู ุงููููุงุช ุงููุคูุชุฉ:
```bash
rm -rf /data/uploads/temp/*
```

**Q: What if disk is full?**
**A:** You can increase disk size in Render settings, or delete temp files:
```bash
rm -rf /data/uploads/temp/*
```

---

### ุงูุฏุนู | Support

ุฅุฐุง ูุงุฌูุช ูุดุงูู ูู ุงูุชุฑุญูู:
1. ุชุญูู ูู ุงูุณุฌูุงุช
2. ุฑุงุฌุน [STORAGE.md](STORAGE.md)
3. ุงูุชุญ issue ูู GitHub

If you face migration issues:
1. Check logs
2. Review [STORAGE.md](STORAGE.md)
3. Open a GitHub issue

---

### ุงูุฎูุงุตุฉ | Summary

โ **ูุจู**: ุงูุจูุงูุงุช ุชูููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู
โ **ุจุนุฏ**: ุงูุจูุงูุงุช ูุญููุธุฉ ุฏุงุฆูุงู ูู `/data`

โ **Before**: Data lost on restart
โ **After**: Data permanently saved in `/data`

๐ ุงุณุชูุชุน ุจุชุฌุฑุจุฉ ุจูุช ุฃุฐูุงุฑ ุฃูุซุฑ ููุซูููุฉ!
๐ Enjoy a more reliable Azkar bot experience!
